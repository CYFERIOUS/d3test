function pyramidChart(){var t={restrict:"A",scope:{data:"@"},templateUrl:"../directives/pyramid-chart.html",controller:"pyramidCtrl",controllerAs:"pyrmd"};return t}function pyramidCtrl(t,r){function a(t,r){return"translate("+t+","+r+")"}function e(t){return d3.format(".1%")(t).replace(".",",")}var n={};$(document).ready(function(){d3.csv(t.data,function(t,r){var a=["Hombres","Mujeres","etn_Hombres","etn_Mujeres"];n.max=d3.max(r,function(t){return a.map(function(r){return t[r]}).reduce(function(t,r){return parseInt(t)>parseInt(r)?parseInt(t):parseInt(r)})}),n.total=d3.sum(r,function(t){return t.Total}),n.data=[],r.forEach(function(t){n.data.push({edad:parseInt(t),rango_edad:t.Edad,total_hombres:parseInt(t.Hombres),total_mujeres:parseInt(t.Mujeres),total:parseInt(t.Hombres)+parseInt(t.Mujeres),etn_hombres:parseInt(t.etn_Hombres),etn_mujeres:parseInt(t.etn_Mujeres),etn:parseInt(t.etn_Hombres)+parseInt(t.etn_Mujeres)})})})}),t.grafico=function(t){function o(r,o,s){var m=15,C=r[t.value+"_hombres"],v=r[t.value+"_mujeres"],x=f(v/n.total),y=h.append("rect").attr("x",d).attr("y",o*p).attr("width",0).attr("height",u).attr("class","barraMujeres");y.transition().attr("width",x).duration(2e3);var b=h.append("text").attr("x",c-45).attr("y",o*p+m).attr("class","etiquetaMujeres").text(e(v/n.total));b.transition().attr("x",c-45+x).duration(2e3);var j=f(C/n.total),g=h.append("rect").attr("x",l-60).attr("y",o*p).attr("width",0).attr("transform",a(2*l,0)+" scale(-1,1)").attr("height",u).attr("class","barraHombres");g.transition().attr("width",j).duration(2e3);var I=h.append("text").attr("x",l+20).attr("y",o*p+m).attr("class","etiquetaHombres").text(e(C/n.total));I.transition().attr("x",l+20-j).duration(2e3);var _=r.rango_edad;h.append("text").attr("x",i).attr("y",o*p+m).attr("text-anchor","middle").attr("class","etiquetaEdad").text(_)}d3.selectAll("svg").remove();var i=340,d=380,s=720,l=s/3,c=2*l-50,u=18,p=25,m=n.data.length*p,h=d3.select(r[0]).append("svg").attr("height",m).attr("width",s).attr("class","piramide"),f=d3.scale.linear().domain([0,n.max/n.total]).range([0,l]);n.data.forEach(function(t,r){o(t,r)})}}function donutChart(){var t={restrict:"A",scope:{data:"@"},controller:"donutCtrl"};return t}function donutCtrl(t,r){d3.json(t.data,function(t,a){if(t)return console.warn(t);c3.generate({bindto:r[0],size:{width:600,height:600},data:{columns:a,type:"donut"},donut:{label:{format:function(t,r,a){return d3.format(".1%")(r).replace(".",",")}}},tooltip:{show:!1},title:"pobreza por el IPM Ajustado",legend:{item:{onclick:function(t){}}}})})}function mapChart(){var t={restrict:"A",scope:{data:"@"},controller:"mapCtrl"};return t}function mapCtrl(t,r){console.log(t.data)}var app=angular.module("maps",[]);app.directive("pyramidChart",pyramidChart).controller("pyramidCtrl",pyramidCtrl),pyramidCtrl.$inject=["$scope","$element"],app.directive("donutChart",donutChart).controller("donutCtrl",donutCtrl),donutCtrl.$inject=["$scope","$element"],app.directive("mapChart",mapChart).controller("mapCtrl",mapCtrl),mapCtrl.$inject=["$scope","$element"];
//# sourceMappingURL=../maps/d3.min.js.map
